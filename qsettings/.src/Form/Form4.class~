' Gambas class file

Private $hCursor As CCursor
Private sPath As String

Public Sub List_Theme_Icons()
  
  Dim cThemes As New Collection
  Dim sTheme As String
  Dim sDir As String
  Dim aThemes As New String[]
  Dim pIcon As Picture
  Dim sPath As String
  Dim sFile As String
  Dim i As Integer
  
  sPath = "/usr/share/icons/"
  For Each sDir In RDir(sPath, "*cursors", True)
    
    cThemes[sDir] = True
  Next
  
  sPath = Desktop.DataDir &/ "icons/"
  For Each sDir In RDir(sPath, "*cursors", True)
    Print File.Dir(sDir)
    cThemes[sDir] = True
  Next
  
  For Each cThemes
    aThemes.Add(cThemes.Key)
  Next
  
  aThemes.Sort(gb.Ascent)
  For Each sTheme In aThemes 
    Inc i
    LtvCursor.add(i, sTheme)
    
  Next
  
Catch
  Mkdir (Desktop.DataDir &/ "icons/")
  List_Theme_Icons
  
End

Public Sub Form_Open()
  
  sPath = "/usr/share/icons/"
  FileView1.dir = sPath
  List_Theme_Icons
  
  Label1.Text = FileView1.Dir
  
End

Public Sub FileView1_Select()
  
  ' Dim sPath As String
  
  sPath = FileView1.dir &/ FileView1.Current
  If Stat(sPath).Type = gb.File Then
    
    Try $hCursor = New CCursor(sPath)
    
    If Not Error Then
      
      DrawingArea1.Refresh
    Endif
    
  Endif
  
End

Public Sub DrawingArea1_Draw()
  
  Dim i As Integer
  Dim yPos As Integer
  
  If Not $hCursor Then Return
  
  For i = 0 To $hCursor.Count - 1
    Paint.DrawImage($hCursor[i].Image, (DrawingArea1.ClientW - $hCursor[i].Image.Width) / 2, yPos - DrawingArea1.Scrolly)
    yPos += $hCursor[i].Height + 5
  Next
  
  DrawingArea1.ResizeContents(DrawingArea1.Width, yPos)
  
End

Public Sub FileView1_DblClick()
  
  Dim sPath As String = FileView1.Dir &/ FileView1.Current
  
  If Not IsDir(sPath) Then Return
  FileView1.dir = sPath
  Label1.Text = FileView1.Dir
  
End

Public Sub ToolButton1_Click()
  
  FileView1.Dir = File.Dir(FileView1.Dir)
  Label1.Text = FileView1.Dir
  
End

Public Sub LtvCursor_Click()
  
  ' Dim sPath As String
  
  sPath = "/usr/share/icons/"
  
  FileView1.Dir = sPath &/ LtvCursor.Item.Text 
  Label1.Text = sPath &/ LtvCursor.Item.Text 
  
End

Public Sub LtvCursor_Select()
  
  sPath = "/usr/share/icons/"
  
  FileView1.Dir = sPath &/ LtvCursor.Item.Text 
  Label1.Text = sPath &/ LtvCursor.Item.Text 
  
End
